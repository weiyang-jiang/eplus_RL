<?xml version="1.0" standalone="no"?>
<!DOCTYPE entity PUBLIC "-//UC Berkeley//DTD MoML 1//EN"
    "http://ptolemy.eecs.berkeley.edu/xml/dtd/MoML_1.dtd">
<entity name="Satellite" class="ptolemy.actor.TypedCompositeActor">
    <property name="_createdBy" class="ptolemy.kernel.attributes.VersionAttribute" value="8.1.devel">
    </property>
    <property name="Continuous Director" class="ptolemy.domains.continuous.kernel.ContinuousDirector">
        <property name="stopTime" class="ptolemy.data.expr.Parameter" value="6.196129">
        </property>
        <property name="maxStepSize" class="ptolemy.data.expr.Parameter" value="1.0">
        </property>
        <property name="errorTolerance" class="ptolemy.data.expr.Parameter" value="1e-8">
        </property>
        <property name="ODESolver" class="ptolemy.data.expr.StringParameter" value="ExplicitRK45Solver">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[100.0, 45.0]">
        </property>
    </property>
    <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={17, 30, 1052, 737}, maximized=false}">
    </property>
    <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[839, 627]">
    </property>
    <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
    </property>
    <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{419.5, 313.5}">
    </property>
    <property name="miu" class="ptolemy.data.expr.Parameter" value="0.012129">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[630.0, 110.0]">
        </property>
    </property>
    <property name="lambda" class="ptolemy.data.expr.Parameter" value="1 - miu">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[630.0, 130.0]">
        </property>
    </property>
    <property name="initial_y1" class="ptolemy.data.expr.Parameter" value="1.2">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[630.0, 25.0]">
        </property>
    </property>
    <property name="initial_y2" class="ptolemy.data.expr.Parameter" value="0.0">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[630.0, 45.0]">
        </property>
    </property>
    <property name="initial_y3" class="ptolemy.data.expr.Parameter" value="0.0">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[630.0, 65.0]">
        </property>
    </property>
    <property name="initial_y4" class="ptolemy.data.expr.Parameter" value="-1.04936">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[630.0, 85.0]">
        </property>
    </property>
    <property name="Annotation" class="ptolemy.vergil.kernel.attributes.TextAttribute">
        <property name="textColor" class="ptolemy.actor.gui.ColorAttribute" value="{0.2,0.2,0.2,1.0}">
        </property>
        <property name="text" class="ptolemy.kernel.util.StringAttribute" value="Author: Haiyang Zheng">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[30.0, 605.0]">
        </property>
    </property>
    <property name="Annotation2" class="ptolemy.vergil.kernel.attributes.TextAttribute">
        <property name="text" class="ptolemy.kernel.util.StringAttribute" value="This model shows how a satellite moves around the earth and moon &#10;under the gravity. We assume that the satellite, the earth, and the&#10;moon are in the same plane. We also assume there is no friction and &#10;the earch and moon are prefectly round. &#10;&#10;The variables y1 and y2 represent positions of the satellite relative to the earth and&#10;moon. The earth is on (-mu, 0) and the moon is on (1-mu, 0) &#10;always. The constant mu is defined as &#10;        &#10;  mu = Mass_of_Moon / (Mass_of_Moon + Mass_of_Earth) = 0.012129.&#10;&#10;The trajectory of the satellite is a periodic curve and the period is &#10;around 6.192169. &#10;&#10;This demo is based on the example 10.6 in &quot;Introduction of Computation Method&quot;,&#10;by Cuiwei Xu, 1985, Higher Education Press. &#10;">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="{30.0, 330.0}">
        </property>
    </property>
    <property name="Annotation3" class="ptolemy.vergil.kernel.attributes.TextAttribute">
        <property name="textColor" class="ptolemy.actor.gui.ColorAttribute" value="{0.0,0.6,0.2,1.0}">
        </property>
        <property name="text" class="ptolemy.kernel.util.StringAttribute" value="Note: Here we use the RK45Solver which&#10;has better performance than the &#10;RK23Solver.  To see the difference,&#10;double click on the ContinuousDirector&#10;and change the ODESolver parameter.&#10;">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[525.0, 300.0]">
        </property>
    </property>
    <entity name="y1" class="ptolemy.domains.continuous.lib.Integrator">
        <property name="initialState" class="ptolemy.actor.parameters.PortParameter" value="initial_y1">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[361.5, 55.0]">
        </property>
    </entity>
    <entity name="y2" class="ptolemy.domains.continuous.lib.Integrator">
        <property name="initialState" class="ptolemy.actor.parameters.PortParameter" value="initial_y2">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[350.0185546875, 290.7257080078125]">
        </property>
    </entity>
    <entity name="y3" class="ptolemy.domains.continuous.lib.Integrator">
        <property name="initialState" class="ptolemy.actor.parameters.PortParameter" value="initial_y3">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[181.5, 100.0]">
        </property>
    </entity>
    <entity name="y4" class="ptolemy.domains.continuous.lib.Integrator">
        <property name="initialState" class="ptolemy.actor.parameters.PortParameter" value="initial_y4">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[180.0, 255.0]">
        </property>
    </entity>
    <entity name="Expression" class="ptolemy.actor.lib.Expression">
        <property name="expression" class="ptolemy.kernel.util.StringAttribute" value="y1 + 2*y4 - lambda*(y1 + miu)/pow(((y1 + miu)^2 + y2^2), 3.0/2) - miu*(y1 - lambda)/pow(((y1 - lambda)^2 + y2^2), 3.0/2)">
            <property name="style" class="ptolemy.actor.gui.style.LineStyle">
            </property>
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
            <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="expression">
            </property>
            <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="60">
            </property>
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[241.5, 203.28125]">
        </property>
        <port name="output" class="ptolemy.actor.TypedIOPort">
            <property name="output"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="WEST">
            </property>
        </port>
        <port name="y1" class="ptolemy.actor.TypedIOPort">
            <property name="input"/>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
        </port>
        <port name="y2" class="ptolemy.actor.TypedIOPort">
            <property name="input"/>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
        </port>
        <port name="y4" class="ptolemy.actor.TypedIOPort">
            <property name="input"/>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
        </port>
    </entity>
    <entity name="Expression2" class="ptolemy.actor.lib.Expression">
        <property name="expression" class="ptolemy.kernel.util.StringAttribute" value="y2 - 2*y3 - lambda*y2/pow(((y1 + miu)^2 + y2^2), 3.0/2) - miu*y2/pow(((y1 - lambda)^2 + y2^2), 3.0/2)">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
            <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="expression">
            </property>
            <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="60">
            </property>
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[245.0, 150.0]">
        </property>
        <port name="output" class="ptolemy.actor.TypedIOPort">
            <property name="output"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="WEST">
            </property>
        </port>
        <port name="y1" class="ptolemy.actor.TypedIOPort">
            <property name="input"/>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
        </port>
        <port name="y2" class="ptolemy.actor.TypedIOPort">
            <property name="input"/>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
        </port>
        <port name="y3" class="ptolemy.actor.TypedIOPort">
            <property name="input"/>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
        </port>
    </entity>
    <entity name="Trajectory" class="ptolemy.actor.lib.gui.XYPlotter">
        <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={54, 337, 438, 347}, maximized=false}">
        </property>
        <property name="_plotSize" class="ptolemy.actor.gui.SizeAttribute" value="[438, 303]">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[580.0, 230.0]">
        </property>
        <port name="inputX" class="ptolemy.actor.TypedIOPort">
            <property name="input"/>
            <property name="multiport"/>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="inputY" class="ptolemy.actor.TypedIOPort">
            <property name="input"/>
            <property name="multiport"/>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <configure>
<?plotml <!DOCTYPE plot PUBLIC "-//UC Berkeley//DTD PlotML 1//EN"
"http://ptolemy.eecs.berkeley.edu/xml/dtd/PlotML_1.dtd">
<plot>
<title>Satellite Trajectory</title>
<xLabel></xLabel>
<yLabel></yLabel>
<xRange min="-1.2621151587183537" max="1.2"/>
<yRange min="-0.6678441150454416" max="0.6679569743152095"/>
</plot>?>
        </configure>
    </entity>
    <relation name="relation3" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[296.5, 100.0]">
        </vertex>
    </relation>
    <relation name="relation" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[295.0, 255.0]">
        </vertex>
    </relation>
    <relation name="relation2" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[485.0, 55.0]">
        </vertex>
    </relation>
    <relation name="relation4" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[460.0, 290.0]">
        </vertex>
    </relation>
    <relation name="relation7" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[20.0, 100.0]">
        </vertex>
    </relation>
    <relation name="relation6" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[30.0, 255.0]">
        </vertex>
    </relation>
    <link port="y1.derivative" relation="relation3"/>
    <link port="y1.state" relation="relation2"/>
    <link port="y2.derivative" relation="relation"/>
    <link port="y2.state" relation="relation4"/>
    <link port="y3.derivative" relation="relation7"/>
    <link port="y3.state" relation="relation3"/>
    <link port="y4.derivative" relation="relation6"/>
    <link port="y4.state" relation="relation"/>
    <link port="Expression.output" relation="relation7"/>
    <link port="Expression.y1" relation="relation2"/>
    <link port="Expression.y2" relation="relation4"/>
    <link port="Expression.y4" relation="relation"/>
    <link port="Expression2.output" relation="relation6"/>
    <link port="Expression2.y1" relation="relation2"/>
    <link port="Expression2.y2" relation="relation4"/>
    <link port="Expression2.y3" relation="relation3"/>
    <link port="Trajectory.inputX" relation="relation2"/>
    <link port="Trajectory.inputY" relation="relation4"/>
</entity>
