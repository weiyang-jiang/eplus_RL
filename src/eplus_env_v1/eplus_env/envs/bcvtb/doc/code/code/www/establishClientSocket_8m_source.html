<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Building Controls Virtual Test Bed: establishClientSocket.m Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Building Controls Virtual Test Bed
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('establishClientSocket_8m_source.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">establishClientSocket.m</div>  </div>
</div><!--header-->
<div class="contents">
<a href="establishClientSocket_8m.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="establishClientSocket_8m.html#a4fb6a738bd03cd2771f10bc8789ec812">    1</a></span>&#160;<span class="keyword">function</span> <a class="code" href="establishClientSocket_8m.html#a4fb6a738bd03cd2771f10bc8789ec812">sockfd</a> = establishClientSocket(socketConfigurationFile)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;% ESTABLISHCLIENTSOCKET - Establishes the client connection to the socket</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;%</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;%   <a class="code" href="establishClientSocket_8m.html#a4fb6a738bd03cd2771f10bc8789ec812">sockfd</a> = establishClientSocket(&#39;socket.cfg&#39;) connect MATLAB to </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;%   the BCVTB. This <a class="code" href="exchangeDoublesWithSocket_8m.html#a32f8b60b22c4f80750b0ae1e0a5be587">function</a> will read the file socket.cfg to get</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;%   <a class="code" href="slblocks_8m.html#a431ddf5a5e50fe75ed79fd202d413584">information</a> for how to connect to the BCVTB.</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;%  </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;%   If <a class="code" href="processError_8m.html#af87e2b1161dea46a5aab3118429a9755">successful</a>, <a class="code" href="establishClientSocket_8m.html#a4fb6a738bd03cd2771f10bc8789ec812">sockfd</a> will be a positive integer for the </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;%   socket file descriptor. In case of <a class="code" href="establishClientSocket_8m.html#a859694b6d9ceec9462594444c1b61f61">error</a>, <a class="code" href="establishClientSocket_8m.html#a4fb6a738bd03cd2771f10bc8789ec812">sockfd</a> will be negative.</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;%  </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;%   This <a class="code" href="exchangeDoublesWithSocket_8m.html#a32f8b60b22c4f80750b0ae1e0a5be587">function</a> will also load the library libbcvtb unless it is</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;%   already loaded.</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;%  Revision history</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;%  ----------------  </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;%  2009-06-26 MWetter@lbl.gov: First version, based on code of </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;%             Charles Corbin, UC Boulder</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;  </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;% Load library if it is not already loaded</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;BCVTBLIB=getBCVTBLibName();</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keywordflow">if</span> <a class="code" href="establishClientSocket_8m.html#adc1a5a0aad8b1868538d869ab50901a0">~libisloaded</a>(<a class="code" href="processError_8m.html#a8ed06c6267e8fd1a526b27e30c17f0ca">BCVTBLIB</a>)</div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="establishClientSocket_8m.html#a4436ed76464ff5a77cdc35dedc2078d3">   22</a></span>&#160;  <a class="code" href="compile_8m.html#aa20d495184d5ef93b0b851f0b4ce4a39">loadlibrary</a>(<a class="code" href="processError_8m.html#a8ed06c6267e8fd1a526b27e30c17f0ca">BCVTBLIB</a>, @<a class="code" href="establishClientSocket_8m.html#a4436ed76464ff5a77cdc35dedc2078d3">bcvtb</a>);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<a class="code" href="util_2utilXml_8c.html#a66b814b0426b992e7ebe37246bc43ae6">end</a></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<a class="code" href="compile_8m.html#a4a6f78e5437fa712087328fb2273fb77">if</a> ~libisloaded(BCVTBLIB)    </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  msg=&#39;Error. Failed to load BCVTB library.&#39;;</div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="establishClientSocket_8m.html#aeb118d899043dc20122a190fbd0f6376">   26</a></span>&#160;  <a class="code" href="establishClientSocket_8m.html#aeb118d899043dc20122a190fbd0f6376">ME</a> = MException(&#39;BCVTB:ConnectError&#39;, ...</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                  msg);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <a class="code" href="establishClientSocket_8m.html#a02d5496b6774dc4f76888e05e32dc45e">throw</a>(<a class="code" href="establishClientSocket_8m.html#aeb118d899043dc20122a190fbd0f6376">ME</a>);</div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="establishClientSocket_8m.html#a4145a3c50398e0a1aa43c610fc8c35e2">   29</a></span>&#160;  <a class="code" href="establishClientSocket_8m.html#a4145a3c50398e0a1aa43c610fc8c35e2">status</a> = -1; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;else</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="establishClientSocket_8m.html#a4145a3c50398e0a1aa43c610fc8c35e2">status</a> = 1; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<a class="code" href="util_2utilXml_8c.html#a66b814b0426b992e7ebe37246bc43ae6">end</a></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;% Establish the socket connection</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<a class="code" href="compile_8m.html#a4a6f78e5437fa712087328fb2273fb77">if</a> <a class="code" href="establishClientSocket_8m.html#a5f90916e00cff497b4a0c036365e1e4e">and</a>(libisloaded(BCVTBLIB), (status == 1))</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <a class="code" href="establishClientSocket_8m.html#a4fb6a738bd03cd2771f10bc8789ec812">sockfd</a> = calllib(BCVTBLIB,&#39;<a class="code" href="util_2utilSocket_8c.html#a208c7e2df7ba4e9191b605a513e68e97">establishclientsocket</a>&#39;, socketConfigurationFile); </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;else</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <a class="code" href="establishClientSocket_8m.html#a56e9fd9a5f4a2d0311938486ec53d09b">disp</a>(&#39;Could not load library establishClientSocket.m&#39;);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <a class="code" href="establishClientSocket_8m.html#a4fb6a738bd03cd2771f10bc8789ec812">sockfd</a> = -1;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<a class="code" href="util_2utilXml_8c.html#a66b814b0426b992e7ebe37246bc43ae6">end</a></div>
<div class="ttc" id="establishClientSocket_8m_html_a4fb6a738bd03cd2771f10bc8789ec812"><div class="ttname"><a href="establishClientSocket_8m.html#a4fb6a738bd03cd2771f10bc8789ec812">sockfd</a></div><div class="ttdeci">function sockfd</div><div class="ttdef"><b>Definition:</b> <a href="establishClientSocket_8m_source.html#l00001">establishClientSocket.m:1</a></div></div>
<div class="ttc" id="compile_8m_html_aa20d495184d5ef93b0b851f0b4ce4a39"><div class="ttname"><a href="compile_8m.html#aa20d495184d5ef93b0b851f0b4ce4a39">loadlibrary</a></div><div class="ttdeci">loadlibrary(LIBBCVTB,... 'matlabSocket.h',... 'includepath', './..',... 'mfilename', 'bcvtb.m')%-------------------------------------------------------------------%Check if Simulink is installed on this system.If Simulink is%is not installed</div></div>
<div class="ttc" id="slblocks_8m_html_a431ddf5a5e50fe75ed79fd202d413584"><div class="ttname"><a href="slblocks_8m.html#a431ddf5a5e50fe75ed79fd202d413584">information</a></div><div class="ttdeci">function described below The Simulink Library Browser needs to know which libraries in your Blockset it should and what names to give them To provide this information</div><div class="ttdef"><b>Definition:</b> <a href="slblocks_8m_source.html#l00001">slblocks.m:1</a></div></div>
<div class="ttc" id="establishClientSocket_8m_html_a859694b6d9ceec9462594444c1b61f61"><div class="ttname"><a href="establishClientSocket_8m.html#a859694b6d9ceec9462594444c1b61f61">error</a></div><div class="ttdeci">function sockfd will be a positive integer for the socket file descriptor In case of error</div><div class="ttdef"><b>Definition:</b> <a href="establishClientSocket_8m_source.html#l00001">establishClientSocket.m:1</a></div></div>
<div class="ttc" id="establishClientSocket_8m_html_a4436ed76464ff5a77cdc35dedc2078d3"><div class="ttname"><a href="establishClientSocket_8m.html#a4436ed76464ff5a77cdc35dedc2078d3">bcvtb</a></div><div class="ttdeci">if bcvtb</div><div class="ttdef"><b>Definition:</b> <a href="establishClientSocket_8m_source.html#l00022">establishClientSocket.m:22</a></div></div>
<div class="ttc" id="processError_8m_html_af87e2b1161dea46a5aab3118429a9755"><div class="ttname"><a href="processError_8m.html#af87e2b1161dea46a5aab3118429a9755">successful</a></div><div class="ttdeci">function if the BCVTB library can be loaded and if sockfd is not a negative then this function sends signal to the socket If sending a message to the socket was successful</div><div class="ttdef"><b>Definition:</b> <a href="processError_8m_source.html#l00001">processError.m:1</a></div></div>
<div class="ttc" id="establishClientSocket_8m_html_a4145a3c50398e0a1aa43c610fc8c35e2"><div class="ttname"><a href="establishClientSocket_8m.html#a4145a3c50398e0a1aa43c610fc8c35e2">status</a></div><div class="ttdeci">status</div><div class="ttdef"><b>Definition:</b> <a href="establishClientSocket_8m_source.html#l00029">establishClientSocket.m:29</a></div></div>
<div class="ttc" id="util_2utilSocket_8c_html_a208c7e2df7ba4e9191b605a513e68e97"><div class="ttname"><a href="util_2utilSocket_8c.html#a208c7e2df7ba4e9191b605a513e68e97">establishclientsocket</a></div><div class="ttdeci">int establishclientsocket(const char *const docname)</div><div class="ttdoc">Establishes a connection to the socket. </div><div class="ttdef"><b>Definition:</b> <a href="util_2utilSocket_8c_source.html#l00468">util/utilSocket.c:468</a></div></div>
<div class="ttc" id="establishClientSocket_8m_html_a5f90916e00cff497b4a0c036365e1e4e"><div class="ttname"><a href="establishClientSocket_8m.html#a5f90916e00cff497b4a0c036365e1e4e">and</a></div><div class="ttdeci">end Establish the socket connection if and(libisloaded(BCVTBLIB),(status==1)) sockfd</div></div>
<div class="ttc" id="util_2utilXml_8c_html_a66b814b0426b992e7ebe37246bc43ae6"><div class="ttname"><a href="util_2utilXml_8c.html#a66b814b0426b992e7ebe37246bc43ae6">end</a></div><div class="ttdeci">static void XMLCALL end(void *data, const char *el)</div><div class="ttdoc">Call back functions that will be used by the expat xml parser. </div><div class="ttdef"><b>Definition:</b> <a href="util_2utilXml_8c_source.html#l00707">util/utilXml.c:707</a></div></div>
<div class="ttc" id="compile_8m_html_a4a6f78e5437fa712087328fb2273fb77"><div class="ttname"><a href="compile_8m.html#a4a6f78e5437fa712087328fb2273fb77">if</a></div><div class="ttdeci">if(strcmp(os,'windows'))%have Windows LIBBCVTB</div></div>
<div class="ttc" id="establishClientSocket_8m_html_aeb118d899043dc20122a190fbd0f6376"><div class="ttname"><a href="establishClientSocket_8m.html#aeb118d899043dc20122a190fbd0f6376">ME</a></div><div class="ttdeci">ME</div><div class="ttdef"><b>Definition:</b> <a href="establishClientSocket_8m_source.html#l00026">establishClientSocket.m:26</a></div></div>
<div class="ttc" id="processError_8m_html_a8ed06c6267e8fd1a526b27e30c17f0ca"><div class="ttname"><a href="processError_8m.html#a8ed06c6267e8fd1a526b27e30c17f0ca">BCVTBLIB</a></div><div class="ttdeci">Load library if it is not already loaded BCVTBLIB</div><div class="ttdef"><b>Definition:</b> <a href="processError_8m_source.html#l00026">processError.m:26</a></div></div>
<div class="ttc" id="exchangeDoublesWithSocket_8m_html_a32f8b60b22c4f80750b0ae1e0a5be587"><div class="ttname"><a href="exchangeDoublesWithSocket_8m.html#a32f8b60b22c4f80750b0ae1e0a5be587">function</a></div><div class="ttdeci">function[retVal, flaRea, simTimRea, dblValRea]</div><div class="ttdef"><b>Definition:</b> <a href="exchangeDoublesWithSocket_8m_source.html#l00001">exchangeDoublesWithSocket.m:1</a></div></div>
<div class="ttc" id="establishClientSocket_8m_html_a56e9fd9a5f4a2d0311938486ec53d09b"><div class="ttname"><a href="establishClientSocket_8m.html#a56e9fd9a5f4a2d0311938486ec53d09b">disp</a></div><div class="ttdeci">else disp('Could not load library establishClientSocket.m')</div></div>
<div class="ttc" id="establishClientSocket_8m_html_adc1a5a0aad8b1868538d869ab50901a0"><div class="ttname"><a href="establishClientSocket_8m.html#adc1a5a0aad8b1868538d869ab50901a0">~libisloaded</a></div><div class="ttdeci">if ~libisloaded(BCVTBLIB) loadlibrary(BCVTBLIB</div></div>
<div class="ttc" id="establishClientSocket_8m_html_a02d5496b6774dc4f76888e05e32dc45e"><div class="ttname"><a href="establishClientSocket_8m.html#a02d5496b6774dc4f76888e05e32dc45e">throw</a></div><div class="ttdeci">throw(ME)</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_e0ed8aa96b5dd6800a0d8102c6a8fb4c.html">matlab</a></li><li class="navelem"><a class="el" href="establishClientSocket_8m.html">establishClientSocket.m</a></li>
    <li class="footer">Generated on Wed Apr 20 2016 10:24:19 for Building Controls Virtual Test Bed by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
